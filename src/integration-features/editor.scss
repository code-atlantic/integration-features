/**
 * Integration Feature Block - Editor-Only Styles
 *
 * Styles applied only in the WordPress block editor.
 */

// ============================================
// Editor-Specific Block Wrapper
// ============================================

.wp-block-popup-maker-integration-feature {
	// Minimal spacing to match frontend list appearance
	margin-bottom: 0.25rem;

	// Selected state styling
	&.is-selected {
		.pm-integration-feature {
			outline: 2px solid #0073aa;
			outline-offset: 2px;
			border-radius: 4px;
		}
	}

	// Hovered state (when not selected)
	&:not(.is-selected):hover {
		.pm-integration-feature {
			background-color: rgba(0, 115, 170, 0.03);
			border-radius: 4px;
		}
	}

	// Make accordion icon clearly clickable
	.pm-integration-feature__icon[role="button"] {
		cursor: pointer;
		transition: color 0.2s ease;
		padding: 0.25em;
		margin: -0.25em;
		border-radius: 3px;

		&:hover {
			color: #0073aa;
			background-color: rgba(0, 115, 170, 0.1);
		}

		&:focus {
			outline: 2px solid #0073aa;
			outline-offset: 2px;
		}
	}

	// Add description affordance (+ icon)
	.pm-integration-feature__add-description {
		cursor: pointer;
		transition: all 0.2s ease;
		padding: 0.25em 0.5em;
		margin: -0.25em;
		border-radius: 3px;
		opacity: 0.6;

		&:hover {
			opacity: 1;
			color: #0073aa;
			background-color: rgba(0, 115, 170, 0.1);
		}

		&:focus {
			outline: 2px solid #0073aa;
			outline-offset: 2px;
			opacity: 1;
		}
	}
}

// ============================================
// Editor RichText Placeholder
// ============================================

.pm-integration-feature__label {
	// RichText placeholder styling
	.block-editor-rich-text__editable[data-is-placeholder-visible='true']::before {
		color: #9ca3af;
		opacity: 0.8;
	}

	// Empty state styling
	&:empty::before {
		content: attr(placeholder);
		color: #9ca3af;
		opacity: 0.8;
	}
}

// ============================================
// InnerBlocks Area
// ============================================

.pm-integration-feature__description {
	// InnerBlocks appender (add block button)
	.block-list-appender {
		margin-top: 0.25rem;
		margin-bottom: 0;
	}

	// Empty state placeholder
	&:empty {
		position: relative;
		min-height: 1.5rem;

		&::before {
			content: 'Add optional description...';
			position: absolute;
			top: 50%;
			left: 0;
			transform: translateY(-50%);
			color: #9ca3af;
			font-size: 0.875rem;
			font-style: italic;
			pointer-events: none;
		}
	}

	// Nested block styling
	.block-editor-block-list__layout {
		margin-top: 0;
		margin-bottom: 0;
	}

	// Inner block selected state - minimal spacing
	.wp-block {
		margin-top: 0.25rem;
		margin-bottom: 0.25rem;

		&:first-child {
			margin-top: 0.25rem;
		}

		&:last-child {
			margin-bottom: 0;
		}
	}
}

// ============================================
// Editor Panel & Placeholder
// ============================================

.pm-integration-feature__panel {
	margin: 0;
	padding: 0;

	&.is-hidden {
		display: none;
	}

	&.is-visible {
		display: block;
	}
}

.pm-integration-feature__placeholder {
	margin: 0;
	padding: 0.25rem 0;

	p {
		margin: 0 0 0.25rem 0;
		font-size: 0.875rem;
		color: #6b7280;
		font-style: italic;
	}
}

// ============================================
// Block Toolbar & Controls
// ============================================

// Ensure toolbar controls are properly styled
.block-editor-block-toolbar {
	.pm-integration-feature & {
		// Custom toolbar button styling if needed
	}
}

// ============================================
// InnerBlocks Editing Protection
// ============================================

.pm-integration-feature.has-description {
	// Ensure inner blocks are always editable in editor
	.pm-integration-feature__panel {
		// Prevent clicks on panel from bubbling to header
		pointer-events: auto;

		// Make sure inner blocks are fully interactive
		.block-editor-block-list__layout {
			pointer-events: auto;
		}

		// Ensure all inner block controls are accessible
		.block-list-appender,
		.wp-block {
			pointer-events: auto;
		}
	}
}

// ============================================
// Inspector Panel Styling
// ============================================

// Tier selector in sidebar
.components-panel__body {
	.pm-tier-selector {
		margin-bottom: 1rem;

		.components-base-control__label {
			margin-bottom: 0.5rem;
			font-weight: 500;
		}
	}
}

// ============================================
// Block Variations Picker
// ============================================

.block-editor-block-variation-picker {
	.pm-integration-feature-variation {
		// Custom variation preview styling
		padding: 1rem;

		.pm-tier-badge {
			margin-bottom: 0.5rem;
		}
	}
}

// ============================================
// Drag & Drop States
// ============================================

.pm-integration-feature {
	// When block is being dragged
	&.is-dragging {
		opacity: 0.5;
	}

	// When hovering during drag operation
	&.is-dragging-over {
		border-color: #0073aa;
		background-color: rgba(0, 115, 170, 0.05);
	}
}

// ============================================
// Multi-Select State
// ============================================

.is-multi-selected {
	.pm-integration-feature {
		box-shadow: 0 0 0 1px #0073aa;
	}
}

// ============================================
// Editor Dark Mode Support
// ============================================

.is-dark-theme {
	.pm-integration-feature {
		&.has-description details[open] {
			background-color: #1e1e1e;
			border-color: #3a3a3a;
			box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
		}

		.pm-integration-feature__label {
			color: #e0e0e0;
		}

		.pm-integration-feature__description {
			border-top-color: #3a3a3a;

			p,
			ul,
			ol {
				color: #b0b0b0;
			}

			h1,
			h2,
			h3,
			h4,
			h5,
			h6 {
				color: #e0e0e0;
			}
		}
	}
}

// ============================================
// Responsive Editor Layout
// ============================================

@media (max-width: 782px) {
	.pm-integration-feature__header {
		padding: 0.375rem;
		gap: 0.375rem;

		// More padding when expanded
		details[open] & {
			padding: 0.5rem 0.75rem;
		}
	}

	.pm-tier-badge {
		font-size: 0.6875rem;
		padding: 0.25rem 0.5rem;
	}

	.pm-integration-feature__description {
		padding: 0 0.75rem 0.75rem 0.75rem;
	}
}
